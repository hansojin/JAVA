## select 명령문과 공통 요소

### 리터럴(Literal)

* 리터럴(literal)은 고정되거나 변경할 수 없는 값으로 상수(constant)
* select 명령문에서 행을 선택하는 조건에 사용되거나  insert 명령문에서 새로운 행에 값을 지정하기 위해서 사용
* 각 리터럴은 테이블에서 열과 같은 특별한 자료형을 가지고 있음
    * 정수 리터럴
    * 십진 리터럴
    * 부동 소수점 리터럴
    * 영수치 리터럴
    * 날짜 리터럴

1. 정수 리터럴
    * 정수 리터럴(interger literal)은 전체가 정수이거나 소수점이 없는 정수로써 양 의 부호(+) 또는 음의 부호(-)를 가질 수 있다. 정수 리터럴의 예는 다음과 같다.
        * 38, +12, -3404, -16

2. 십진 리터럴
    * 소수점을 가지고 있거나 가지지 않는 수로서 필요하다면 양 또는 음의 부호를 사용할  수 있다. 각 정수 리터럴은 십진 리터럴 정의에 따른다. 십진 리터럴의 예는 다음과 같다.
        * 49, 18.47, -3400, -16, 0.83459, -349
    * 소수점 앞에 있는 숫자의 수를 정밀도(precision)라 하며 소수점 뒤에 있는 숫자의 수를 크기(scale) 라 한다.
        * 십진 리터럴 123.45는 3개의 정밀도와 2개의 크기를 가지고 있다.
    * MySQL의 Number 데이터형에서는 123.45 값을 처리하기 위해서는 Size를 5자리 이상, Scale을 2자리 이상으로 정의하여 사용해야 한다.
        * suchi float(5, 2) not null 	// 123.45, 12.3	값이 입력 가능

3. 부동 소수점 리터럴
    * 지수를 가지고 있는 십진 리터럴
        * 49, 18.47, 4E-3

4. 영수치 리터럴
    * 인용부호(')로 감싼 0 또는 그 이상의 영수치 문자로 구성된 문자열
        * 여기서 인용부호는 리터럴에 포함되지 않고 문자열의 시작과 끝
        * 모든 영문자의 소문자(a-z)
        * 모든 영문자의 대문자(A-Z)
        * 모든 숫자(0-9)
        * 특수 기호(+, =, ?, _)

5. 날짜 리터럴
    * 연도(year), 달(month), 일(day)로 구성하여 날짜를 표현
    * 날짜를 구성하는 3개의 요소는 슬래쉬('/')로 구분되어 있는데, 앞에 0은 생략할 수 있으며, 년도가 2자리 수치를 사용한다면 19가 두 자리 수치 앞에 생략된 것
        * 1980/12/08 >> 8 December 1980
        * 99/1/1 >> 1 January 1999

---

### 수식

수식(expression)은 하나 이상의 연산자와 필요할 경우 괄호를 사용하여 하나의 값을 표현한다. 이러한 값은 영수치, 수치 또는 날짜 자료형을 가질 수 있다. 수식은 다양한 형식을 취할 수 있다. SQL에서는 수식을 사용하는데, 예를 들면 select 명령문의 select와 where 절에서 수식이 사용된다.

다음 예제는 1학년 신입생의 경우에만 입학금을 내고 재학생의 경우에는 입학금을 내지 않으므로 등록금총액(fee_total)은 "입학금(fee_enter) + 수업료(fee_price)"가 된다. 그러나, 입학금이 NULL인 경우에는 가산을 할 수 없으므로 ifnull(fee_enter, 0)와 같이 **ifnull()함수** 를 사용하여 null 값을 0으로 변환하여 가산을 할 수 있다.

```
-- 등록금 총액을 변경하라.
use haksa_database;
update fee set fee_total = ifnull(fee_enter, 0) + fee_price;

-- 납입금 총액은 "등록금 총액 - 장학금 총액"이다. 납입금 총액을 변경하라.
update fee set fee_pay = fee_total - ifnull(jang_total, 0);

-- 우편번호가 150-051 인 동이름과 지역전화번호(동이름과 지역번호는 합쳐서)를 출력하라.
select post_no, concat(post_dong, ddd) from post where post_no = '150-051';
```

---

### 숫자처리 함수

1. round, truncate 함수
* **round 함수** 는 숫자를 소수점 이하 자릿수에서 **반올림** (자릿수는 양수, 0, 음수를 갖을 수 있다.)한다. 자릿수를 생략하면 소숫점이 5 이상일 때 반올림/자릿수를 지정하면 지정한 자리수에서 반올림한다.
* **truncate함수** 는 숫자를 소수점 이하 자릿수에서 **버린다.** n은 자릿수를 소숫점 이하로 정하며, 해당숫자가 자릿수보다 소숫점이 모자랄 경우 0값으로 대치한다. 만일 자릿수를 소숫점 이전(음수 값)으로 정하면 소숫점 이하는 버리고, n의 자릿수만큼 0값으로 처리된다. truncate함수는 반드시 자릿수를 명시해 주어야 한다.

    ```
    -- 형식
    round(column_name or value, n)
    truncate(column_name or value, n)

    -- 예제
    round(123456.789, 2)    # 123456.79
    truncate(123456.789, 2) # 123456.78

    round(12345678.901, -3)     #12346000
    truncate(12345678.901, -3)  #12345000
    ```

2. **floor, ceil 함수**
* floor 함수는 위에서 다룬 truncate 함수와 유사하여 소수점 아래의 수를 무조건 절삭하여 정수 값을 반환
* ceil 함수는 소수점 아래의 수는 무시하고 무조건 올림을 하여 정수를 반환

    ```
    -- 형식
    floor(column_name or value)
    ceil(column_name or value)

    -- 예제
    floor(123456.789)   #123456
    ceil(123456.123)    #123457
    ```

3. **mod 함수**
* 첫 번째 인수를 두 번째 인수로 나누어 **나머지를 반환**
* 두 번째 인수가 첫 번째 인수보다 크거나 0(zero)일 경우 결과 값은 첫 번째 인수를 반환
    * 일반 수식 계산은 0(zero)으로 나눌 경우 에러가 출력되지만, mod 함수에서는 두 번째 인수가 0(zero)이라도 에러를 출력하지 않는다.

    ```
    -- 형식
    mod(column_name1 or value1(분자), column_name2 or value2(분모))
    ```

4. abs함수
    * 절대값을 출력하는 함수

5. pow함수 또는 power함수
    * 제곱의 값을 구하는 함수
    * 소숫점이 있는 경우에도 실행이된다
    * 단, 음수는 양수로 승처리 된다.

6. greatest, least함수
    * greatest 함수는 주어진 숫자중 가장 큰 수를 반환
    * least는 반대로 가장 작은 수를 반환

    ```
    --- 예제
    select greatest(15, 45, 32, 65), least(15, 45, 32, 65);
    ```


```
-- Q. 재학생들의 등록 금액에 비례한 장학금의 비율은 몇 % 인가?

select fee_total "등록금액", jang_total "장학금액", round(ifnull(jang_total, 0) / fee_total*100, 2) "비율" from fee;

```

---

### 스칼라 함수

스칼라 함수(scalar function)는 **연산을 수행** 하기 위해서 사용된다. 스칼라 함수는 전달 인수를 사용하지 않거나 하나 이상의 전달 인수를 사용한다. 문자 처리 함수는 문자열 조작에 관한 함수들이 있다. **concat** 함수는 **두 문자열을 연결** 시켜 합쳐주고, **substring** 함수는 **지정된 위치에서 지정된 길이만큼의 문자열을 추출** 한다. **length** 함수는 문자열의 길이를 정수값으로 반환한다. **instr** 함수는 **문자열에서 특정 문자의 위치를 반환** 하고, **lpad** 함수는 **왼쪽에 지정된 문자를 지정된 길이만큼 채워주고,** **rpad** 함수는 **오른쪽에** 지정된 문자를 지정된 길이만큼 채워준다. 문자 처리 함수의 또 한 종류는 대소문자를 변환해주는 문자열 조작에 관한 함수들이 있다. **lower** 함수는 문자열을 모두 소문자로 바꾸어 주고, **upper** 함수는 문자열을 모두 대문자로 바꾸어준다. **initcap** 함수는 문자열에 속한 각 단어별로 **첫 글자를 대문자로, 나머지 부분은 소문자로 바꾸어준다.**

```
concat('Data', 'Base') ---> DataBase
substring('Korea', 1, 3) ---> Kor
length('lee_woo') ---> 7
instr('Korea', 'e') ---> 4
lpad('Korea', 15, '*') ---> **********Korea
rpad('Korea', 15, '#') ---> Korea##########
lower('Korea') ---> korea
upper('Korea') ---> KOREA
INITCAP ('KOREA UNIVERSITY') ---> Korea University (오라클)
```

---

#### 공백 또는 문자 제거

* trim : 문자열에 공백 또는 문자를 제거
    * leading : 좌측 공백/문자 제거
    * trailing : 우측 공백/문자 제거
    * both : 좌우 공백/문자 제거(기본)
* ltrim : 문자열의 좌측 공백 제거
* rtrim : 문자열의 우측 공백 제거